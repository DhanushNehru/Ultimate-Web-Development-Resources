#include <stdio.h>
#include <stdlib.h>

struct node {
	int key;
	int val;
	struct node* left;
	struct node* right;
};

struct node* create_node(int key, int val) {
	struct node* ptr = (struct node*)malloc(sizeof(struct node));
	ptr->key = key;
	ptr->val = val;
	ptr->left = ptr->right = NULL;
	return ptr;
}

struct node* insert(struct node* root, int key, int val) {
	if (root == NULL) {
		return create_node(key, val);
	}
	if (key < root->key) {
		root->left = insert(root->left, key, val);
	} else if (key > root->key) {
		root->right = insert(root->right, key, val);
	}
	return root;
}

int getval(struct node* root, int key) {
	struct node* temp = root;
	int flag = 0;
	while (temp != NULL) {
		if (temp->key == key) {
			flag = 1;
			break;
		} else if (key > temp->key) {
			temp = temp->right;
		} else {
			temp = temp->left;
		}
	}
	if (flag == 1) {
		return temp->val;
	}
	printf("\nKey:%d not found\n", key);
	return -999; // return -999 if not found
}

void write_to_dot(struct node* root, FILE* fp) {
	if (root->left != NULL) {
		fprintf(fp, "\t\"%d : %d\" -> \"%d : %d\" [label = \"left\"];\n", root->key, root->val, root->left->key, root->left->val);
		write_to_dot(root->left, fp);
	}
	if (root->right != NULL) {
		fprintf(fp, "\t\"%d : %d\" -> \"%d : %d\" [label = \"right\"];\n", root->key, root->val, root->right->key, root->right->val);
		write_to_dot(root->right, fp);
	}
}

void write_to_dot_full(struct node* root, FILE* fp, const char name[]) {
	fprintf(fp, "digraph BST { \nlabel= \"%s\"", name);
	write_to_dot(root, fp);
	fprintf(fp, "}");
}

void inorder(struct node* root) {
	if (root != NULL) {
		inorder(root->left);
		printf("%d : %d, ", root->key, root->val);
		inorder(root->right);
	}
}

int main() {
	int a[1000] = {405, 213, 971, 295, 951, 412, 669, 255, 564, 697, 104, 502, 563, 416, 528, 217, 767, 145, 540, 353, 408, 308, 192, 668, 190, 118, 444, 579, 136, 353, 913, 461, 111, 872, 395, 529, 245, 167, 628, 301, 959, 388, 132, 443, 289, 884, 674, 314, 279, 166, 115, 932, 498, 863, 335, 841, 807, 440, 449, 776, 742, 426, 174, 460, 263, 333, 678, 317, 334, 348, 793, 954, 255, 584, 165, 650, 192, 141, 441, 877, 487, 315, 435, 730, 646, 865, 130, 476, 473, 118, 146, 511, 536, 407, 143, 300, 534, 568, 662, 441, 790, 691, 821, 761, 253, 172, 710, 160, 832, 222, 475, 376, 639, 941, 390, 875, 305, 185, 954, 979, 256, 364, 304, 497, 723, 405, 708, 840, 665, 689, 418, 523, 501, 442, 410, 429, 362, 225, 936, 342, 109, 740, 518, 651, 481, 397, 398, 966, 976, 187, 410, 711, 524, 854, 582, 136, 130, 302, 689, 369, 338, 816, 625, 368, 175, 187, 938, 704, 461, 804, 142, 800, 805, 679, 150, 717, 776, 692, 787, 862, 214, 614, 193, 802, 936, 487, 474, 378, 737, 382, 339, 879, 354, 296, 381, 306, 571, 519, 842, 872, 688, 616, 830, 230, 736, 488, 225, 613, 703, 157, 783, 460, 618, 575, 854, 262, 702, 174, 358, 309, 948, 394, 909, 865, 779, 855, 331, 140, 747, 613, 500, 620, 581, 702, 296, 254, 355, 792, 732, 411, 922, 754, 585, 881, 291, 331, 230, 819, 505, 922, 897, 635, 325, 292, 178, 404, 739, 835, 892, 137, 207, 424, 402, 456, 902, 376, 426, 870, 907, 928, 198, 930, 227, 807, 926, 704, 954, 911, 244, 104, 102, 278, 283, 294, 257, 450, 265, 211, 123, 433, 358, 855, 938, 654, 451, 131, 691, 997, 893, 271, 149, 300, 367, 913, 313, 620, 281, 265, 247, 443, 369, 872, 929, 799, 718, 945, 400, 940, 756, 327, 239, 144, 122, 229, 428, 607, 157, 507, 880, 583, 285, 968, 480, 965, 903, 485, 750, 936, 727, 558, 644, 665, 696, 800, 743, 541, 937, 894, 656, 640, 256, 385, 463, 891, 131, 621, 851, 849, 924, 688, 855, 945, 946, 528, 427, 286, 417, 413, 844, 886, 487, 548, 543, 937, 974, 430, 101, 651, 953, 628, 923, 368, 138, 880, 733, 676, 455, 147, 662, 177, 546, 352, 601, 681, 124, 143, 514, 971, 819, 998, 614, 499, 191, 831, 760, 501, 922, 809, 258, 169, 988, 714, 694, 136, 834, 110, 136, 598, 808, 648, 316, 127, 891, 703, 323, 675, 286, 134, 154, 770, 204, 589, 546, 717, 653, 414, 752, 105, 144, 113, 409, 219, 609, 843, 455, 189, 329, 825, 224, 875, 337, 106, 556, 534, 256, 944, 248, 878, 309, 110, 222, 416, 342, 111, 631, 622, 396, 766, 294, 563, 606, 494, 118, 229, 321, 962, 244, 496, 412, 968, 511, 321, 299, 522, 731, 703, 753, 847, 503, 430, 637, 967, 252, 486, 844, 359, 898, 528, 190, 517, 101, 645, 216, 614, 679, 939, 895, 154, 145, 586, 656, 931, 569, 117, 851, 351, 114, 442, 651, 692, 993, 121, 189, 812, 681, 467, 908, 226, 674, 741, 316, 233, 963, 802, 323, 872, 686, 595, 880, 927, 679, 954, 274, 839, 972, 674, 300, 548, 855, 795, 162, 967, 723, 861, 677, 904, 869, 511, 801, 714, 998, 736, 754, 351, 798, 156, 921, 569, 456, 163, 894, 951, 870, 990, 784, 531, 159, 179, 872, 318, 657, 990, 123, 172, 289, 232, 699, 815, 259, 341, 610, 883, 225, 623, 527, 388, 668, 578, 349, 429, 472, 506, 979, 837, 162, 415, 730, 131, 492, 566, 634, 715, 579, 326, 142, 319, 706, 511, 146, 712, 493, 751, 305, 861, 782, 729, 773, 816, 839, 773, 345, 104, 519, 340, 594, 988, 851, 566, 142, 710, 699, 734, 931, 292, 752, 643, 766, 845, 646, 467, 467, 553, 384, 734, 877, 912, 380, 765, 221, 973, 436, 365, 209, 385, 989, 728, 831, 348, 922, 848, 626, 234, 316, 234, 642, 828, 691, 882, 889, 827, 260, 553, 376, 446, 457, 217, 595, 180, 317, 218, 778, 600, 225, 298, 292, 269, 827, 462, 641, 396, 536, 218, 933, 872, 869, 374, 517, 453, 252, 564, 811, 162, 528, 776, 406, 956, 788, 639, 117, 971, 487, 599, 887, 223, 253, 216, 235, 720, 255, 396, 181, 267, 936, 466, 422, 666, 265, 709, 430, 666, 697, 945, 344, 752, 185, 905, 834, 849, 488, 627, 143, 293, 150, 610, 312, 491, 770, 839, 140, 460, 186, 491, 351, 140, 809, 815, 475, 168, 147, 144, 391, 915, 196, 932, 397, 549, 361, 127, 545, 396, 472, 250, 482, 143, 136, 530, 537, 224, 919, 857, 407, 131, 786, 118, 718, 868, 200, 355, 115, 573, 490, 113, 919, 185, 278, 817, 717, 270, 733, 540, 199, 232, 288, 640, 666, 904, 656, 945, 298, 107, 772, 421, 229, 141, 627, 141, 735, 107, 141, 573, 287, 952, 589, 587, 992, 330, 140, 325, 235, 142, 767, 456, 309, 927, 253, 543, 275, 826, 954, 495, 887, 604, 369, 159, 721, 716, 455, 509, 334, 643, 979, 215, 755, 747, 915, 438, 571, 952, 853, 807, 103, 932, 314, 778, 357, 820, 110, 497, 489, 775, 344, 824, 869, 281, 946, 835, 989, 513, 330, 219, 807, 229, 281, 299, 408, 178, 701, 156, 337, 132, 351, 357, 246, 697, 181, 631, 405, 325, 124, 487, 269, 532, 523, 306, 160, 872, 445, 205, 611, 196, 175, 731, 672, 797, 461, 884, 436, 394, 216, 166, 608, 312, 177, 673, 892, 200, 854, 370, 854, 520, 878, 775, 230, 889, 673, 626, 578, 908, 452, 540, 758, 341, 247, 818, 307, 741, 776, 596, 428, 101, 538, 702, 976, 139, 758, 228, 121, 993, 621, 759, 318, 987, 868, 427, 863, 328, 356, 123, 759, 110, 863, 561, 223, 247, 924, 963, 135, 763, 646, 228, 158, 237, 155, 793, 590, 722, 991, 660, 412, 569};

    struct node* root = NULL; // initialize with NULL
    for (int i = 0; i < 1000; i += 2) {
        root = insert(root, a[i], a[i + 1]); // instantiate with values
    }

    FILE* fp = fopen("keyval_tree.dot", "w");
    write_to_dot_full(root, fp, "key value pairs");
    fclose(fp);

    return 0;
}
